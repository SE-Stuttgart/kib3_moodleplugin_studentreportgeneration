{"version":3,"file":"file_selection.min.js","sources":["../src/file_selection.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\nimport {\n    initPageSelection\n} from \"mod_srg/page_selection\";\n\n/**\n * Create and support the data viewing in html.\n *\n * @module     mod_srg/file_selection\n * @copyright  2024 University of Stuttgart <kasra.habib@iste.uni-stuttgart.de>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Support for data_view.js, call only after rendering template/file_navigation.\n * Initialize the file-selection UI and delegate further html renders.\n * Set file index 0 as default starting file.\n */\nexport function initFileSelection() {\n    initTabListeners();\n    setActiveTab(0);\n}\n\n/**\n * Setup the Tab Listeners.\n */\nfunction initTabListeners() {\n    const tabs = document.querySelectorAll(\".srg-tab-container .nav-link\");\n\n    tabs.forEach((tab, index) => {\n        tab.addEventListener(\"click\", (event) => {\n            event.preventDefault();\n            setActiveTab(index);\n        });\n    });\n}\n\n/**\n * Display the tab content.\n * @param {Element} tab - The tab to display content for.\n */\nfunction initTabContent(tab) {\n    const data = JSON.parse(atob(tab.getAttribute(\"data-content\") || \"e30=\"));\n\n    // Create an array (for the pagination template) with one object per page, starting at value 1;\n    const pages = Array.from(data, (_, index) => ({ index: index + 1 }));\n\n    if (pages.length > 0) {\n        initPageSelection(pages);\n    }\n}\n\n/**\n * Sets a new active tab and updates the tab content.\n * @param {int} nextTabIndex - Index of the new active tab.\n */\nfunction setActiveTab(nextTabIndex) {\n    const tabs = document.querySelectorAll(\".srg-tab-container .nav-link\");\n    const dataElement = document.querySelector(\".srg-page-container\");\n    const topPagination = document.querySelector(\".srg-page-navigation-container-top\");\n    const tableContainer = document.querySelector(\".srg-tab-content-container\");\n    const bottomPagination = document.querySelector(\".srg-page-navigation-container-bottom\");\n\n    // Reset tab content.\n    topPagination.innerHTML = \"\";\n    tableContainer.innerHTML = \"\";\n    bottomPagination.innerHTML = \"\";\n\n    // Update the active file index information.\n    dataElement.dataset.activeFileIndex = nextTabIndex;\n\n\n    tabs.forEach((tab, index) => {\n        const isActive = index === nextTabIndex;\n        tab.classList.toggle(\"srg-tab-active\", isActive);\n        tab.setAttribute(\"aria-selected\", isActive ? \"true\" : \"false\");\n\n        if (isActive) {\n            initTabContent(tab);\n        }\n    });\n}"],"names":["setActiveTab","nextTabIndex","tabs","document","querySelectorAll","dataElement","querySelector","topPagination","tableContainer","bottomPagination","innerHTML","dataset","activeFileIndex","forEach","tab","index","isActive","classList","toggle","setAttribute","data","JSON","parse","atob","getAttribute","pages","Array","from","_","length","initTabContent","addEventListener","event","preventDefault"],"mappings":"kHAsESA,aAAaC,oBACZC,KAAOC,SAASC,iBAAiB,gCACjCC,YAAcF,SAASG,cAAc,uBACrCC,cAAgBJ,SAASG,cAAc,sCACvCE,eAAiBL,SAASG,cAAc,8BACxCG,iBAAmBN,SAASG,cAAc,yCAGhDC,cAAcG,UAAY,GAC1BF,eAAeE,UAAY,GAC3BD,iBAAiBC,UAAY,GAG7BL,YAAYM,QAAQC,gBAAkBX,aAGtCC,KAAKW,SAAQ,CAACC,IAAKC,eACTC,SAAWD,QAAUd,aAC3Ba,IAAIG,UAAUC,OAAO,iBAAkBF,UACvCF,IAAIK,aAAa,gBAAiBH,SAAW,OAAS,SAElDA,mBApCYF,WACdM,KAAOC,KAAKC,MAAMC,KAAKT,IAAIU,aAAa,iBAAmB,SAG3DC,MAAQC,MAAMC,KAAKP,MAAM,CAACQ,EAAGb,UAAaA,MAAOA,MAAQ,MAE3DU,MAAMI,OAAS,yCACGJ,OA8BdK,CAAehB;;;;;;;;WAnDVX,SAASC,iBAAiB,gCAElCS,SAAQ,CAACC,IAAKC,SACfD,IAAIiB,iBAAiB,SAAUC,QAC3BA,MAAMC,iBACNjC,aAAae,aAZrBf,aAAa"}